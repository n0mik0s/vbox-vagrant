docker run -d --restart=unless-stopped \
  -p 80:80 -p 443:443 \
  -v /root/certs:/container/certs \
  -v /opt/rancher:/var/lib/rancher \
  -e SSL_CERT_DIR="/container/certs" \
  --privileged \
  rancher/rancher:latest

systemctl stop ufw.service && systemctl disable ufw.service 

apt update && apt install -y freeipa-client resolvconf

vi /etc/resolvconf/resolv.conf.d/head
nameserver 192.168.207.80
search my.local


systemctl restart resolvconf.service && systemctl restart systemd-resolved.service

ipa-client-install --hostname=`hostname -f` \
--mkhomedir \
--server=freeipa.my.local \
--domain my.local \
--realm MY.LOCAL

This program will set up FreeIPA client.
Version 4.8.6

WARNING: conflicting time&date synchronization service 'ntp' will be disabled in favor of chronyd

Autodiscovery of servers for failover cannot work with this configuration.
If you proceed with the installation, services will be configured to always access the discovered server for all operations and will not fail over to other servers in case of failure.
Proceed with fixed values and no DNS discovery? [no]: yes
Do you want to configure chrony with NTP server or pool address? [no]: yes
Enter NTP source server addresses separated by comma, or press Enter to skip: 0.ua.pool.ntp.org,1.ua.pool.ntp.org,2.ua.pool.ntp.org,3.ua.pool.ntp.org
Enter a NTP source pool address, or press Enter to skip: 
Client hostname: master.my.local
Realm: MY.LOCAL
DNS Domain: my.local
IPA Server: freeipa.my.local
BaseDN: dc=my,dc=local
NTP server: 0.ua.pool.ntp.org
NTP server: 1.ua.pool.ntp.org
NTP server: 2.ua.pool.ntp.org
NTP server: 3.ua.pool.ntp.org

Continue to configure the system with these values? [no]: yes
Synchronizing time
Configuration of chrony was changed by installer.
Attempting to sync time with chronyc.
Time synchronization was successful.
User authorized to enroll computers: admin
Password for admin@MY.LOCAL: 
Successfully retrieved CA cert
    Subject:     CN=Certificate Authority,O=MY.LOCAL
    Issuer:      CN=Certificate Authority,O=MY.LOCAL
    Valid From:  2022-03-21 16:01:26
    Valid Until: 2042-03-21 16:01:26

Joining realm failed: Host is already joined.

Use --force-join option to override the host entry on the server and force client enrollment.
Installation failed. Rolling back changes.
Disabling client Kerberos and LDAP configurations
Restoring client configuration files
nscd daemon is not installed, skip configuration
nslcd daemon is not installed, skip configuration
Some installation state for ntp has not been restored, see /var/lib/ipa/sysrestore/sysrestore.state
Some installation state has not been restored.
This may cause re-installation to fail.
It should be safe to remove /var/lib/ipa-client/sysrestore.state but it may
 mean your system hasn't been restored to its pre-installation state.
Client uninstall complete.